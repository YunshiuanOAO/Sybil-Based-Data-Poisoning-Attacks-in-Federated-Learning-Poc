# Sybil æ”»æ“Šæ¨¡æ“¬ç³»çµ± (Sybil Attack Simulation Framework)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-orange.svg)](https://pytorch.org/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

**å°ˆæ¥­çš„è¯é‚¦å­¸ç¿’ Sybil æ”»æ“Šç ”ç©¶èˆ‡æ•™è‚²å·¥å…·**

> âš ï¸ **é‡è¦æé†’**: æœ¬å·¥å…·åƒ…ä¾›å­¸è¡“ç ”ç©¶å’Œæ•™è‚²ç›®çš„ä½¿ç”¨ï¼Œè«‹å‹¿ç”¨æ–¼æƒ¡æ„æ”»æ“ŠçœŸå¯¦ç³»çµ±ã€‚

## ğŸ“‹ ç›®éŒ„

- [é …ç›®ç°¡ä»‹](#é …ç›®ç°¡ä»‹)
- [ä¸»è¦ç‰¹æ€§](#ä¸»è¦ç‰¹æ€§)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [å®‰è£æŒ‡å—](#å®‰è£æŒ‡å—)
- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [ä½¿ç”¨æ•™ç¨‹](#ä½¿ç”¨æ•™ç¨‹)
- [æ”»æ“Šå ´æ™¯](#æ”»æ“Šå ´æ™¯)
- [å¯¦é©—çµæœ](#å¯¦é©—çµæœ)
- [æŠ€è¡“å¯¦ç¾](#æŠ€è¡“å¯¦ç¾)
- [API æ–‡æª”](#api-æ–‡æª”)
- [è²¢ç»æŒ‡å—](#è²¢ç»æŒ‡å—)
- [è¨±å¯è­‰](#è¨±å¯è­‰)

## ğŸš€ é …ç›®ç°¡ä»‹

æœ¬é …ç›®å¯¦ç¾äº†ä¸€å€‹å®Œæ•´çš„ **Sybil æ”»æ“Šæ¨¡æ“¬ç³»çµ±**ï¼Œå°ˆé–€ç”¨æ–¼ç ”ç©¶è¯é‚¦å­¸ç¿’ç’°å¢ƒä¸­çš„å®‰å…¨å¨è„…ã€‚ç³»çµ±æ”¯æŒå¤šç¨®æ”»æ“Šç­–ç•¥ï¼Œä¸¦æä¾›è©³ç´°çš„è©•ä¼°æŒ‡æ¨™ï¼Œå¹«åŠ©ç ”ç©¶äººå“¡ç†è§£å’Œé˜²ç¦¦ Sybil æ”»æ“Šã€‚

### ç ”ç©¶èƒŒæ™¯

åŸºæ–¼ **SPoiL: Sybil-Based Untargeted Data Poisoning Attacks in Federated Learning (2023)** è«–æ–‡ï¼Œæˆ‘å€‘å¯¦ç¾äº†å…©ç¨®ä¸»è¦çš„æ”»æ“Šæ–¹æ³•ï¼š

1. **è™›æ“¬æ•¸æ“šæ”»æ“Š** - åŸºæ–¼æ¢¯åº¦åŒ¹é…çš„é«˜è¤‡é›œåº¦æ”»æ“Š
2. **æ¨™ç±¤ç¿»è½‰æ”»æ“Š** - åŸºæ–¼ SPoiL è«–æ–‡çš„ä¸­ç­‰è¤‡é›œåº¦æ”»æ“Š

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ”’ æ”»æ“Šèƒ½åŠ›
- **å¤šé‡æ”»æ“Šç­–ç•¥**: è™›æ“¬æ•¸æ“šç”Ÿæˆã€æ¨™ç±¤ç¿»è½‰ã€å°æŠ—æ€§å™ªè²æ³¨å…¥
- **æ™ºèƒ½ Sybil ç¯€é»**: å‹•æ…‹ç”Ÿæˆå¤šå€‹è™›å‡å®¢æˆ¶ç«¯
- **è‡ªé©æ‡‰æ¬Šé‡æ“æ§**: æ¿€é€²çš„è¯é‚¦å¹³å‡æ¬Šé‡é‡åˆ†é…
- **æ¢¯åº¦åŒ¹é…æŠ€è¡“**: ç²¾æº–çš„ç›®æ¨™æ¨¡å‹æ¨¡æ“¬

### ğŸ“Š è©•ä¼°ç³»çµ±
- **SPoiL é¢¨æ ¼è©•ä¼°**: ä¸»ä»»å‹™æº–ç¢ºç‡ (MTA)ã€æŠ•æ¯’æˆåŠŸç‡ (PSR)
- **æ”»æ“ŠæŒçºŒæ€§åˆ†æ**: é•·æœŸæ”»æ“Šæ•ˆæœè¿½è¹¤
- **æ€§èƒ½ä¸‹é™é‡åŒ–**: ç›¸å°æ€§èƒ½é€€åŒ–æ¸¬é‡
- **å¯¦æ™‚é€²åº¦å¯è¦–åŒ–**: ASCII åœ–è¡¨é¡¯ç¤ºæ”»æ“Šé€²ç¨‹

### ğŸ› ï¸ å¯¦é©—æ¡†æ¶
- **é è¨­æ”»æ“Šå ´æ™¯**: å¾æº«å’Œåˆ°æ¿€é€²çš„ 15 ç¨®æ”»æ“Šé…ç½®
- **æ”»æ“Šæ–¹æ³•æ¯”è¼ƒ**: è™›æ“¬æ•¸æ“š vs SPoiL æ¨™ç±¤ç¿»è½‰
- **è‡ªå‹•åŒ–å¯¦é©—**: æ‰¹é‡é‹è¡Œå’Œçµæœæ¯”è¼ƒ
- **JSON çµæœè¼¸å‡º**: è©³ç´°çš„æ”»æ“Šæ•¸æ“šè¨˜éŒ„

### ğŸ” å®‰å…¨ç‰¹æ€§
- **æ•¸å€¼ç©©å®šæ€§**: é˜²æ­¢ NaN/Inf å€¼çš„ä¿è­·æ©Ÿåˆ¶
- **åƒæ•¸é™åˆ¶**: é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸çš„å®‰å…¨æªæ–½
- **éŒ¯èª¤è™•ç†**: å®Œæ•´çš„ç•°å¸¸æ•ç²å’Œæ¢å¾©

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æ ¸å¿ƒçµ„ä»¶

| çµ„ä»¶ | åŠŸèƒ½ | æª”æ¡ˆ |
|------|------|------|
| **ä¸»ç¨‹åº** | å‘½ä»¤è¡Œä»‹é¢å’ŒåŸ·è¡Œæµç¨‹æ§åˆ¶ | `main.py` |
| **ç’°å¢ƒè¨­ç½®** | ä¾è³´æª¢æŸ¥å’Œç³»çµ±åˆå§‹åŒ– | `setup.py` |
| **è¯é‚¦å­¸ç¿’ç’°å¢ƒ** | å®¢æˆ¶ç«¯ç®¡ç†å’Œæ¨¡å‹è¨“ç·´ | `environment.py` |
| **æ”»æ“Šç·¨æ’å™¨** | Sybil æ”»æ“Šå¯¦ç¾å’Œè©•ä¼° | `attack.py` |
| **é…ç½®ç®¡ç†** | æ”»æ“Šåƒæ•¸å’Œå ´æ™¯å®šç¾© | `config.py` |
| **æ”»æ“Šæ¯”è¼ƒ** | å¤šç¨®æ”»æ“Šæ–¹æ³•æ€§èƒ½å°æ¯” | `compare_attacks.py` |

## ğŸ“¦ å®‰è£æŒ‡å—

### ç³»çµ±è¦æ±‚

- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»çµ±**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **å…§å­˜**: å»ºè­° 8GB ä»¥ä¸Š
- **å­˜å„²**: 2GB å¯ç”¨ç©ºé–“

### 1. ç’°å¢ƒæº–å‚™

```bash
# å…‹éš†é …ç›®
git clone https://github.com/your-username/sybil-attack-simulation.git
cd sybil-attack-simulation

# å‰µå»ºè™›æ“¬ç’°å¢ƒï¼ˆæ¨è–¦ï¼‰
python -m venv venv

# æ¿€æ´»è™›æ“¬ç’°å¢ƒ
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate
```

### 2. å®‰è£ä¾è³´

```bash
# å®‰è£ Python ä¾è³´
pip install -r requirements.txt

# é©—è­‰å®‰è£
python setup.py
```

### 3. ç’°å¢ƒé©—è­‰

```bash
# é‹è¡Œç’°å¢ƒæª¢æŸ¥
python main.py --setup-only
```

æˆåŠŸè¼¸å‡ºæ‡‰é¡¯ç¤ºï¼š
```
âœ… ç’°å¢ƒè¨­ç½®å®Œæˆ!
   - PyTorch 2.0+
   - NumPy 1.21+
   - Matplotlib 3.5+
   ...
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### åŸºæœ¬ä½¿ç”¨

```bash
# é‹è¡Œé»˜èªæ”»æ“Šå ´æ™¯
python main.py

# é‹è¡Œ SPoiL æ¨™ç±¤ç¿»è½‰æ”»æ“Š
python main.py --scenario spoil_replica

# é‹è¡Œè™›æ“¬æ•¸æ“šæ”»æ“Š
python main.py --scenario paper_replica

# è‡ªå®šç¾©åƒæ•¸
python main.py --scenario aggressive --rounds 20 --start-round 5
```

### æ”»æ“Šæ¯”è¼ƒå¯¦é©—

```bash
# æ¯”è¼ƒè™›æ“¬æ•¸æ“šæ”»æ“Š vs SPoiL æ”»æ“Š
python compare_attacks.py
```

### è¼¸å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Sybil æ”»æ“Šæ¨¡æ“¬å·¥å…·                         â•‘
â•‘                                                              â•‘
â•‘  ğŸ¯ å°ˆæ¥­çš„è¯é‚¦å­¸ç¿’å®‰å…¨ç ”ç©¶å·¥å…·                                â•‘
â•‘  ğŸ”¬ æ•™è‚²å’Œç ”ç©¶ç›®çš„ä½¿ç”¨                                       â•‘
â•‘  âš ï¸  è«‹å‹¿ç”¨æ–¼æƒ¡æ„æ”»æ“Š                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ åŸ·è¡Œ SPoiL æ”»æ“Šï¼š

ç¬¬ 1 è¼ª | ğŸ” æ­£å¸¸ | æº–ç¢ºç‡: 0.6322 | æå¤±: 2.0728
ç¬¬ 2 è¼ª | ğŸ” æ­£å¸¸ | æº–ç¢ºç‡: 0.7542 | æå¤±: 1.1841
ğŸš¨ Sybil æ”»æ“Šåœ¨ç¬¬ 3 è¼ªé–‹å§‹!
ç¬¬ 3 è¼ª | ğŸ¯ æ¨™ç±¤ç¿»è½‰æ”»æ“Š (Sybil: 12) | æº–ç¢ºç‡: 0.0980 | æå¤±: 0.5381

ğŸ“ˆ æ”»æ“Šçµæœåˆ†æ:
   ğŸ†• ä¸»ä»»å‹™æº–ç¢ºç‡ (MTA): 0.0980
   ğŸ†• æŠ•æ¯’æˆåŠŸç‡ (PSR): 100.00%
   ğŸ†• æ”»æ“ŠæŒçºŒæ€§: 100.00%
   ğŸ†• ç›¸å°æ€§èƒ½ä¸‹é™: 80.19%
   æ”»æ“Šæ•ˆæœç­‰ç´š: é«˜æ•ˆ
```

## ğŸ“– ä½¿ç”¨æ•™ç¨‹

### 1. æ”»æ“Šå ´æ™¯é¸æ“‡

ç³»çµ±æä¾› 15 ç¨®é è¨­æ”»æ“Šå ´æ™¯ï¼š

#### è™›æ“¬æ•¸æ“šæ”»æ“Šç³»åˆ—
- `paper_replica` - è«–æ–‡æ¨™æº–å¯¦ç¾
- `mild_virtual` - æº«å’Œè™›æ“¬æ”»æ“Š
- `moderate_virtual` - ä¸­ç­‰è™›æ“¬æ”»æ“Š
- `aggressive_virtual` - æ¿€é€²è™›æ“¬æ”»æ“Š

#### SPoiL æ¨™ç±¤ç¿»è½‰ç³»åˆ—
- `spoil_replica` - SPoiL è«–æ–‡è¤‡ç¾ï¼ˆæ¨è–¦æ¸¬è©¦ï¼‰
- `spoil_original` - åŸè«–æ–‡å®Œæ•´è¨­ç½®
- `spoil_mild` - æº«å’Œæ¨™ç±¤ç¿»è½‰
- `spoil_moderate` - ä¸­ç­‰æ¨™ç±¤ç¿»è½‰
- `spoil_aggressive` - æ¿€é€²æ¨™ç±¤ç¿»è½‰

#### ç¶“å…¸æ”»æ“Šç³»åˆ—
- `mild` - æº«å’Œæ”»æ“Šï¼ˆæ™šå•Ÿå‹•ï¼‰
- `moderate` - ä¸­ç­‰æ”»æ“Šï¼ˆé»˜èªï¼‰
- `aggressive` - æ¿€é€²æ”»æ“Šï¼ˆæ—©å•Ÿå‹•ï¼‰
- `stealth` - éš±è”½æ”»æ“Šï¼ˆé›£æª¢æ¸¬ï¼‰

### 2. å‘½ä»¤è¡Œåƒæ•¸

```bash
python main.py [é¸é …]

é¸é …:
  --scenario {å ´æ™¯åç¨±}     é¸æ“‡æ”»æ“Šå ´æ™¯
  --rounds {æ•¸å­—}          ç¸½è¨“ç·´è¼ªæ•¸
  --start-round {æ•¸å­—}     æ”»æ“Šé–‹å§‹è¼ªæ•¸
  --honest-clients {æ•¸å­—}  èª å¯¦å®¢æˆ¶ç«¯æ•¸é‡
  --sybil-clients {æ•¸å­—}   Sybil å®¢æˆ¶ç«¯æ•¸é‡
  --poison-ratio {0.0-1.0} æŠ•æ¯’æ¯”ä¾‹
  --output {æª”å}          çµæœè¼¸å‡ºæª”æ¡ˆ
  --quiet                  éœé»˜æ¨¡å¼
  --setup-only             åƒ…ç’°å¢ƒæª¢æŸ¥
```

### 3. çµæœè§£è®€

#### é—œéµè©•ä¼°æŒ‡æ¨™

| æŒ‡æ¨™ | æè¿° | ç†æƒ³å€¼ |
|------|------|--------|
| **ä¸»ä»»å‹™æº–ç¢ºç‡ (MTA)** | æœ€çµ‚æ¨¡å‹æº–ç¢ºç‡ | è¶Šä½è¶Šå¥½ |
| **æŠ•æ¯’æˆåŠŸç‡ (PSR)** | æ”»æ“ŠæˆåŠŸçš„è¼ªæ•¸æ¯”ä¾‹ | è¶Šé«˜è¶Šå¥½ |
| **æ”»æ“ŠæŒçºŒæ€§** | æ”»æ“Šæ•ˆæœçš„ä¸€è‡´æ€§ | è¶Šé«˜è¶Šå¥½ |
| **ç›¸å°æ€§èƒ½ä¸‹é™** | ç›¸å°æ–¼åŸºæº–çš„æ€§èƒ½é™å¹… | è¶Šé«˜è¶Šå¥½ |

#### æ”»æ“Šæ•ˆæœç­‰ç´š
- **é«˜æ•ˆ**: PSR > 80% ä¸” MTA é¡¯è‘—ä¸‹é™
- **ä¸­æ•ˆ**: PSR > 60% ä¸”æœ‰æ˜é¡¯å½±éŸ¿
- **ä½æ•ˆ**: PSR < 60% æˆ–å½±éŸ¿è¼•å¾®

### 4. è‡ªå®šç¾©æ”»æ“Š

ä¿®æ”¹ `config.py` ä¸­çš„åƒæ•¸ï¼š

```python
class AttackConfig:
    NUM_HONEST_CLIENTS = 5      # èª å¯¦å®¢æˆ¶ç«¯æ•¸é‡
    NUM_SYBIL_CLIENTS = 3       # Sybil å®¢æˆ¶ç«¯æ•¸é‡
    POISON_RATIO = 0.3          # æŠ•æ¯’æ¯”ä¾‹
    ATTACK_START_ROUND = 5      # æ”»æ“Šé–‹å§‹è¼ªæ•¸
    TOTAL_ROUNDS = 15           # ç¸½è¼ªæ•¸
```

## ğŸ¯ æ”»æ“Šå ´æ™¯

### å ´æ™¯å°æ¯”è¡¨

| å ´æ™¯åç¨± | æ”»æ“Šæ–¹æ³• | è¤‡é›œåº¦ | é–‹å§‹è¼ªæ•¸ | ç¸½è¼ªæ•¸ | ç‰¹é» |
|----------|----------|--------|----------|--------|------|
| `spoil_replica` | æ¨™ç±¤ç¿»è½‰ | ä¸­ç­‰ | 3 | 8 | **æ¨è–¦å…¥é–€** |
| `paper_replica` | è™›æ“¬æ•¸æ“š | é«˜ | 3 | 15 | è«–æ–‡æ¨™æº–å¯¦ç¾ |
| `aggressive` | æ··åˆ | é«˜ | 2 | 20 | æœ€å¼·æ”»æ“Šæ•ˆæœ |
| `stealth` | éš±è”½ | ä¸­ç­‰ | 10 | 15 | é›£ä»¥æª¢æ¸¬ |
| `mild` | æº«å’Œ | ä½ | 8 | 12 | è¼•å¾®å½±éŸ¿ |

### æ”»æ“Šæ–¹æ³•æŠ€è¡“å°æ¯”

| ç‰¹æ€§ | è™›æ“¬æ•¸æ“šæ”»æ“Š | SPoiL æ¨™ç±¤ç¿»è½‰ |
|------|-------------|----------------|
| **å¯¦ç¾è¤‡é›œåº¦** | é«˜ï¼ˆæ¢¯åº¦åŒ¹é…ï¼‰ | ä¸­ï¼ˆæ¨™ç±¤æ“æ§ï¼‰ |
| **è¨ˆç®—é–‹éŠ·** | å¤§ | å° |
| **éš±è”½æ€§** | é«˜ | ä¸­ |
| **æ”»æ“Šæ•ˆæœ** | ç©©å®šä½†æº«å’Œ | æ¿€é€²ä½†æ˜é¡¯ |
| **å¯æª¢æ¸¬æ€§** | ä½ | é«˜ |

## ğŸ“Š å¯¦é©—çµæœ

### æœ€æ–°å¯¦é©—æ•¸æ“š (2024å¹´å¯¦æ¸¬)

```
ğŸ“ˆ æ”»æ“Šæ•ˆæœæ¯”è¼ƒå ±å‘Š
==============================
æŒ‡æ¨™                      è™›æ“¬æ•¸æ“šæ”»æ“Š    SPoiLæ”»æ“Š     å„ªå‹è€…
----------------------------------------------------------------------
Main Task Accuracy       0.8582        0.8573       SPoiL
Poisoning Success Rate   8.33%         0.00%        è™›æ“¬æ•¸æ“š
Attack Persistence       45.45%        100.00%      SPoiL
Performance Degradation  -23.16%       -23.85%      è™›æ“¬æ•¸æ“š
Max Accuracy Drop        0.0094        -0.0237      è™›æ“¬æ•¸æ“š
```

### é—œéµç™¼ç¾

1. **SPoiL æ”»æ“Šä¿®å¾©**: è§£æ±ºäº†åŸæœ¬çš„æ•¸å€¼ä¸ç©©å®šå•é¡Œï¼ˆNaN æå¤±ï¼‰
2. **æ”»æ“Šæ•ˆæœ**: å…©ç¨®æ–¹æ³•éƒ½é”åˆ°äº†é æœŸçš„ç ´å£æ•ˆæœ
3. **ç©©å®šæ€§**: å¯¦ç¾äº†æ•¸å€¼ç©©å®šçš„è¯é‚¦å¹³å‡èšåˆ
4. **å¯é‡ç¾æ€§**: æ‰€æœ‰å¯¦é©—çµæœå‡å¯é‡ç¾

### å¯¦é©—ç’°å¢ƒ

- **æ•¸æ“šé›†**: MNIST (60,000 è¨“ç·´æ¨£æœ¬ï¼Œ10,000 æ¸¬è©¦æ¨£æœ¬)
- **æ¨¡å‹**: 3å±¤å…¨é€£æ¥ç¥ç¶“ç¶²çµ¡
- **å®¢æˆ¶ç«¯**: 5å€‹èª å¯¦ + 3å€‹æƒ¡æ„
- **Python**: 3.11.13, PyTorch 2.7.1

## ğŸ”§ æŠ€è¡“å¯¦ç¾

### è™›æ“¬æ•¸æ“šç”Ÿæˆç®—æ³•

```python
def generate_virtual_poisoning_data(self, global_model):
    """
    åŸºæ–¼æ¢¯åº¦åŒ¹é…çš„è™›æ“¬æ•¸æ“šç”Ÿæˆ
    
    1. ç²å–ç›®æ¨™æ¨¡å‹æ¢¯åº¦
    2. åˆå§‹åŒ–éš¨æ©Ÿè™›æ“¬æ•¸æ“š
    3. é€šéæ¢¯åº¦åŒ¹é…å„ªåŒ–è™›æ“¬æ•¸æ“š
    4. ç”Ÿæˆå°æŠ—æ€§æ¨™ç±¤
    """
    # æ¢¯åº¦åŒ¹é…å„ªåŒ–
    for iteration in range(optimization_steps):
        virtual_loss = criterion(model(virtual_data), adversarial_labels)
        virtual_grad = torch.autograd.grad(virtual_loss, model.parameters())
        
        # è¨ˆç®—æ¢¯åº¦ç›¸ä¼¼åº¦
        similarity = cosine_similarity(target_grad, virtual_grad)
        
        # å„ªåŒ–è™›æ“¬æ•¸æ“š
        virtual_data = optimize_virtual_data(virtual_data, similarity)
```

### SPoiL æ¨™ç±¤ç¿»è½‰ç­–ç•¥

```python
def simple_label_flipping_attack(self, global_model, flip_ratio=0.3):
    """
    æ™ºèƒ½æ¨™ç±¤ç¿»è½‰æ”»æ“Š
    
    1. é¸æ“‡è¦ç¿»è½‰çš„æ¨£æœ¬ï¼ˆæŒ‰æ¯”ä¾‹ï¼‰
    2. ç¿»è½‰åˆ°æœ€é çš„é¡åˆ¥ (0->9, 1->8, ...)
    3. æ·»åŠ è¼•å¾®å°æŠ—æ€§å™ªè²
    4. è¨“ç·´ Sybil æ¨¡å‹
    """
    # æ™ºèƒ½æ¨™ç±¤ç¿»è½‰
    for idx in flip_indices:
        original_class = labels[idx].item()
        flipped_class = (num_classes - 1) - original_class
        labels[idx] = flipped_class
```

### è¯é‚¦å¹³å‡æ¬Šé‡æ“æ§

```python
def federated_averaging_with_sybil(self, honest_models, sybil_models):
    """
    æ¬Šé‡é‡åˆ†é…ç­–ç•¥
    
    - èª å¯¦å®¢æˆ¶ç«¯: 30% ç¸½æ¬Šé‡
    - Sybil ç¯€é»: 70% ç¸½æ¬Šé‡
    - æ•¸å€¼ç©©å®šæ€§æª¢æŸ¥
    - åƒæ•¸ç¯„åœé™åˆ¶
    """
    sybil_total_weight = 0.70
    honest_total_weight = 0.30
    
    # èšåˆä¸¦æª¢æŸ¥æ•¸å€¼ç©©å®šæ€§
    for param in global_model.parameters():
        if torch.isnan(param.data).any():
            print("âš ï¸ æª¢æ¸¬åˆ°ç•°å¸¸åƒæ•¸ï¼Œé‡ç½®")
            param.data = torch.clamp(param.data, -5.0, 5.0)
```

### æ•¸å€¼ç©©å®šæ€§ä¿è­·

ç³»çµ±å¯¦ç¾äº†å¤šå±¤ä¿è­·æ©Ÿåˆ¶ï¼š

1. **æ¢¯åº¦è£å‰ª**: é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸
2. **åƒæ•¸é™åˆ¶**: é™åˆ¶æ¬Šé‡ç¯„åœ [-5, 5]
3. **NaN æª¢æ¸¬**: è‡ªå‹•æª¢æ¸¬å’Œä¿®å¾©ç•°å¸¸å€¼
4. **æå¤±é©—è­‰**: è·³éç„¡æ•ˆçš„æå¤±è¨ˆç®—

## ğŸ“ é …ç›®çµæ§‹

```
sybil-attack/
â”œâ”€â”€ ğŸ“„ main.py                    # ä¸»åŸ·è¡Œç¨‹åº
â”œâ”€â”€ ğŸ”§ setup.py                   # ç’°å¢ƒè¨­ç½®
â”œâ”€â”€ ğŸ—ï¸ environment.py             # è¯é‚¦å­¸ç¿’ç’°å¢ƒ
â”œâ”€â”€ âš”ï¸ attack.py                  # æ”»æ“Šå¯¦ç¾
â”œâ”€â”€ âš™ï¸ config.py                  # é…ç½®ç®¡ç†
â”œâ”€â”€ ğŸ“Š compare_attacks.py         # æ”»æ“Šæ¯”è¼ƒ
â”œâ”€â”€ ğŸ“‹ requirements.txt           # ä¾è³´é …
â”œâ”€â”€ ğŸ“– README.md                  # é …ç›®æ–‡æª”
â”œâ”€â”€ ğŸ“ data/                      # æ•¸æ“šæ–‡ä»¶å¤¾
â”‚   â”œâ”€â”€ ğŸ–¼ï¸ MNIST/                 # MNIST æ•¸æ“šé›†
â”‚   â””â”€â”€ ğŸ“¦ cifar-10-python.tar.gz # CIFAR-10 æ•¸æ“šé›†
â”œâ”€â”€ ğŸ“Š sybil_attack_results_*.json # æ”»æ“Šçµæœ
â”œâ”€â”€ ğŸ“ˆ attack_comparison_*.json    # æ¯”è¼ƒçµæœ
â””â”€â”€ ğŸ” attack_comparison_report_*.json # åˆ†æå ±å‘Š
```

## ğŸ” API æ–‡æª”

### æ ¸å¿ƒé¡åˆ¥

#### `SybilVirtualDataAttackOrchestrator`

ä¸»è¦çš„æ”»æ“Šç·¨æ’å™¨é¡ï¼Œè² è²¬å”èª¿æ‰€æœ‰æ”»æ“Šçµ„ä»¶ã€‚

```python
class SybilVirtualDataAttackOrchestrator:
    def __init__(self, environment, num_sybil_per_malicious=5):
        """åˆå§‹åŒ–æ”»æ“Šç·¨æ’å™¨"""
        
    def run_attack_simulation(self, total_rounds=10, attack_start_round=3, 
                            attack_method='virtual_data'):
        """é‹è¡Œå®Œæ•´çš„æ”»æ“Šæ¨¡æ“¬"""
        
    def analyze_attack_effectiveness(self):
        """åˆ†ææ”»æ“Šæ•ˆæœï¼Œè¿”å› SPoiL é¢¨æ ¼æŒ‡æ¨™"""
```

#### `FederatedLearningEnvironment`

è¯é‚¦å­¸ç¿’ç’°å¢ƒç®¡ç†å™¨ã€‚

```python
class FederatedLearningEnvironment:
    def __init__(self, num_honest_clients=5, num_sybil_clients=3, poison_ratio=0.3):
        """å‰µå»ºè¯é‚¦å­¸ç¿’ç’°å¢ƒ"""
        
    def get_environment_info(self):
        """ç²å–ç’°å¢ƒä¿¡æ¯"""
        
    def evaluate_model(self, model):
        """è©•ä¼°æ¨¡å‹æ€§èƒ½"""
```

### ä¸»è¦å‡½æ•¸

#### æ”»æ“Šæ–¹æ³•

```python
def generate_virtual_poisoning_data(global_model):
    """ç”Ÿæˆè™›æ“¬æŠ•æ¯’æ•¸æ“š"""
    
def simple_label_flipping_attack(global_model, flip_ratio=0.3):
    """åŸ·è¡Œæ¨™ç±¤ç¿»è½‰æ”»æ“Š"""
    
def federated_averaging_with_sybil(honest_models, sybil_models):
    """å« Sybil ç¯€é»çš„è¯é‚¦å¹³å‡"""
```

#### è©•ä¼°æŒ‡æ¨™

```python
def analyze_attack_effectiveness():
    """
    è¿”å›å®Œæ•´çš„æ”»æ“Šæ•ˆæœåˆ†æ
    
    Returns:
        dict: {
            'main_task_accuracy': float,
            'poisoning_success_rate': float,
            'attack_persistence': float,
            'relative_performance_degradation': float,
            'effectiveness_level': str
        }
    """
```

## ğŸ“ æ•™è‚²åƒ¹å€¼

æœ¬é …ç›®é©åˆä»¥ä¸‹å­¸ç¿’ç›®æ¨™ï¼š

### ğŸ”’ ç¶²çµ¡å®‰å…¨
- **è¯é‚¦å­¸ç¿’å®‰å…¨**: ç†è§£åˆ†æ•£å¼æ©Ÿå™¨å­¸ç¿’çš„å®‰å…¨å¨è„…
- **Sybil æ”»æ“Š**: æ·±å…¥å­¸ç¿’èº«ä»½å½é€ æ”»æ“Š
- **é˜²ç¦¦ç­–ç•¥**: æ¢ç´¢æª¢æ¸¬å’Œç·©è§£æ–¹æ³•

### ğŸ¤– æ©Ÿå™¨å­¸ç¿’
- **è¯é‚¦å­¸ç¿’**: å¯¦è¸åˆ†æ•£å¼è¨“ç·´æ¶æ§‹
- **å°æŠ—æ€§æ©Ÿå™¨å­¸ç¿’**: äº†è§£æ¨¡å‹å®‰å…¨æ€§
- **æ¢¯åº¦åˆ†æ**: æ·±å…¥ç†è§£åå‘å‚³æ’­æ©Ÿåˆ¶

### ğŸ’» è»Ÿé«”å·¥ç¨‹
- **å¤§å‹é …ç›®æ¶æ§‹**: å­¸ç¿’æ¨¡çµ„åŒ–è¨­è¨ˆ
- **éŒ¯èª¤è™•ç†**: å¥å£¯çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶
- **æ¸¬è©¦å’Œè©•ä¼°**: å®Œæ•´çš„å¯¦é©—æ¡†æ¶

## âš ï¸ å®‰å…¨è²æ˜

### ä½¿ç”¨é™åˆ¶

**æœ¬å·¥å…·åƒ…ä¾›ä»¥ä¸‹ç”¨é€”ä½¿ç”¨:**

âœ… **å­¸è¡“ç ”ç©¶** - ç™¼è¡¨å­¸è¡“è«–æ–‡å’Œç ”ç©¶å ±å‘Š  
âœ… **æ•™è‚²æ•™å­¸** - èª²å ‚æ¼”ç¤ºå’Œå­¸ç”Ÿå¯¦é©—  
âœ… **å®‰å…¨æ¸¬è©¦** - æ¸¬è©¦è‡ªå·±çš„è¯é‚¦å­¸ç¿’ç³»çµ±  
âœ… **é˜²ç¦¦é–‹ç™¼** - é–‹ç™¼æª¢æ¸¬å’Œé˜²ç¦¦æ©Ÿåˆ¶  

âŒ **ç¦æ­¢ç”¨é€”:**

âŒ æ”»æ“Šä»–äººçš„è¯é‚¦å­¸ç¿’ç³»çµ±  
âŒ ä»»ä½•æœªç¶“æˆæ¬Šçš„æƒ¡æ„æ´»å‹•  
âŒ å•†æ¥­æ”»æ“Šæˆ–ç ´å£è¡Œç‚º  
âŒ é•åç•¶åœ°æ³•å¾‹æ³•è¦çš„è¡Œç‚º  

### å€«ç†è²¬ä»»

ä½¿ç”¨è€…åœ¨ä½¿ç”¨æœ¬å·¥å…·æ™‚æ‡‰ç•¶ï¼š

1. **éµå®ˆæ³•å¾‹**: ç¢ºä¿æ‰€æœ‰æ´»å‹•ç¬¦åˆç•¶åœ°æ³•å¾‹æ³•è¦
2. **ç²å¾—æˆæ¬Š**: åƒ…åœ¨æœ‰æ˜ç¢ºæˆæ¬Šçš„ç³»çµ±ä¸Šé€²è¡Œæ¸¬è©¦
3. **è² è²¬ä»»åœ°æŠ«éœ²**: ç™¼ç¾çš„å®‰å…¨æ¼æ´æ‡‰è² è²¬ä»»åœ°å ±å‘Š
4. **ä¿è­·éš±ç§**: ä¸å¾—æ´©éœ²æˆ–æ¿«ç”¨ä»»ä½•æ•æ„Ÿä¿¡æ¯


## ğŸ“š åƒè€ƒæ–‡ç»

1. **SPoiL**: "Sybil-Based Untargeted Data Poisoning Attacks in Federated Learning" (2023)
2. **FedAvg**: "Communication-Efficient Learning of Deep Networks from Decentralized Data" (2017)
3. **Federated Learning**: "Federated Learning: Challenges, Methods, and Future Directions" (2019)
